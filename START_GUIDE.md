# دليل تشغيل مشروع IBEX27

## متطلبات النظام
- Node.js (الإصدار 18 أو أحدث)
- npm أو yarn
- اتصال بالإنترنت (للاتصال بقاعدة البيانات)

---

## خطوات الإعداد الأولي

### 1. تثبيت المتطلبات
```bash
cd ibex27
npm install
```

### 2. تطبيق Migrations على قاعدة البيانات

#### الطريقة الأولى: استخدام Drizzle Kit (موصى بها)
```bash
# تطبيق migrations مباشرة على قاعدة البيانات
npm run db:push
```

#### الطريقة الثانية: استخدام Migrations التلقائية
- سيتم تطبيق migrations تلقائياً عند تشغيل التطبيق لأول مرة
- يمكنك أيضاً تشغيلها يدوياً من داخل التطبيق (إذا كان هناك زر في الإعدادات)

---

## أوامر التشغيل

### 1. تشغيل التطبيق في وضع التطوير (Development)
```bash
npm run dev
```
**ماذا يفعل:**
- يبدأ Electron مع React
- Hot Module Replacement (HMR) مفعل
- DevTools متاح (اضغط F12)
- التغييرات في الكود تظهر فوراً

### 2. بناء التطبيق للإنتاج (Production Build)
```bash
npm run build
```
**ماذا يفعل:**
- يتحقق من أنواع TypeScript
- يبني التطبيق للإنتاج
- الملفات المبنية في مجلد `out/`

### 3. تشغيل النسخة المبنية
```bash
npm start
```
**ماذا يفعل:**
- يشغل النسخة المبنية من `out/`

---

## أوامر قاعدة البيانات

### توليد Migrations جديدة
```bash
npm run db:generate
```
**متى تستخدمه:**
- بعد تعديل `schema.ts`
- لإنشاء ملفات SQL migrations جديدة

### تطبيق Migrations
```bash
npm run db:push
```
**متى تستخدمه:**
- لتطبيق التغييرات على قاعدة البيانات مباشرة
- أسرع من migrations التقليدية

### فتح Drizzle Studio (واجهة قاعدة البيانات)
```bash
npm run db:studio
```
**ماذا يفعل:**
- يفتح واجهة ويب لتصفح قاعدة البيانات
- مفيد للتحقق من البيانات والجداول

---

## معلومات تسجيل الدخول الافتراضية

### مدير المنصة (Platform Admin)
- **البريد الإلكتروني:** `admin@ibex.com`
- **كلمة المرور:** `admin123`
- **الدور:** `platform_admin`

> **ملاحظة:** سيتم إنشاء هذا المستخدم تلقائياً عند أول تشغيل إذا لم يكن موجوداً

---

## هيكل المشروع

```
ibex27/
├── src/
│   ├── main/              # Electron Main Process (Backend)
│   │   ├── schema.ts      # تعريفات قاعدة البيانات
│   │   ├── db.ts          # اتصال قاعدة البيانات
│   │   ├── migrations.ts  # نظام Migrations
│   │   └── ...
│   ├── preload/           # Electron Preload Scripts
│   ├── renderer/          # React UI (Frontend)
│   │   └── src/
│   │       ├── pages/     # صفحات التطبيق
│   │       │   ├── admin/ # صفحات مدير المنصة
│   │       └── ...
│   └── shared/            # كود مشترك
├── drizzle/               # ملفات Migrations
└── package.json
```

---

## استكشاف الأخطاء

### مشكلة: فشل الاتصال بقاعدة البيانات
**الحل:**
1. تحقق من اتصال الإنترنت
2. تحقق من صحة connection string في `src/main/db.ts`
3. تأكد من أن قاعدة البيانات Neon نشطة

### مشكلة: Migrations فشلت
**الحل:**
1. تحقق من وجود مجلد `drizzle/`
2. جرب `npm run db:push` يدوياً
3. تحقق من سجلات الأخطاء في console

### مشكلة: التطبيق لا يبدأ
**الحل:**
1. احذف `node_modules` و `package-lock.json`
2. شغل `npm install` مرة أخرى
3. شغل `npm run build` ثم `npm start`

---

## نصائح للتطوير

1. **استخدم DevTools:** اضغط F12 لفتح أدوات المطور
2. **راقب Console:** جميع الأخطاء تظهر في console
3. **Hot Reload:** التغييرات في React تظهر فوراً
4. **TypeScript:** استخدم `npm run typecheck` للتحقق من الأخطاء

---

## الخطوات التالية بعد التشغيل

1. ✅ سجل دخول كمدير المنصة
2. ✅ أنشئ تاجر جديد من لوحة التحكم
3. ✅ أنشئ متجر للتاجر
4. ✅ جرب تسجيل عميل جديد
5. ✅ جرب عملية بيع مع عميل

---

## الدعم

إذا واجهت أي مشاكل، تحقق من:
- Console logs في DevTools
- ملفات السجلات (إن وجدت)
- حالة قاعدة البيانات في Neon Dashboard

